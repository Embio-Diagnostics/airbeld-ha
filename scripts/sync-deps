#!/usr/bin/env bash

set -e

cd "$(dirname "$0")/.."

echo "ğŸ”„ Syncing dependencies from pyproject.toml to requirements.txt..."
echo

# Check if uv is installed
if ! command -v uv &> /dev/null; then
    echo "âŒ Error: uv not found"
    echo
    echo "   Install uv with:"
    echo "   curl -LsSf https://astral.sh/uv/install.sh | sh"
    exit 1
fi

# Generate requirements.txt from pyproject.toml dev dependencies
echo "ğŸ“ Generating requirements.txt from pyproject.toml..."
uv pip compile pyproject.toml -o requirements.txt --extra dev --quiet

echo "âœ… requirements.txt updated!"
echo
echo "ğŸ“‹ Summary:"
wc -l < requirements.txt | xargs echo "   Generated" && echo "lines in requirements.txt"
echo
echo "ğŸ’¡ Tip: Commit both pyproject.toml and requirements.txt"
